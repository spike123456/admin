(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{0:function(e,t,i){e.exports=i("zUnb")},1:function(e,t){},"9ko8":function(e,t,i){"use strict";i.d(t,"a",function(){return h});var r=i("mrSG"),n=i("7Cbv"),a=i("IheW"),s=i("3y9D"),o=i("i0WE"),c=i("2Vo4"),d=i("N4yJ"),u=i("KM76"),l=i("8Y7J");let h=(()=>{class e{constructor(e,t,i){this.http=e,this.authService=t,this.slackService=i}uploadVideo(e){return Object(r.__awaiter)(this,void 0,void 0,function*(){const t=new c.a(0);return this.http.put(`https://api.github.com/repos/spike123456/video1/contents/${Object(n.a)()}.mp4`,{message:"Add new video",committer:{name:"Admin",email:"admin@netifan.net"},content:yield Object(d.f)(e)},{reportProgress:!0,observe:"events",headers:{authorization:`Bearer ${this.authService.tokenGit}`,accept:"application/vnd.github+json"}}).subscribe(e=>{if(console.log(e),e instanceof a.c)try{const i=e.body.data;console.log(i),t.next([i.content.download_url,i.content.sha])}catch(i){}else void 0!==e.loaded&&void 0!==e.total&&t.next(Math.round(100*e.loaded/e.total))}),t})}removeVideo(e,t){return Object(r.__awaiter)(this,void 0,void 0,function*(){return new Promise((i,n)=>Object(r.__awaiter)(this,void 0,void 0,function*(){try{const r=this.http.request("delete",`https://api.github.com/repos/spike123456/video1/contents/${e}.mp4`,{body:{message:"Remove video",committer:{name:"Admin",email:"admin@netifan.net"},sha:t},headers:{authorization:"Bearer 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",accept:"application/vnd.github+json"}}).subscribe(e=>{i(),r.unsubscribe()})}catch(r){}}))})}doUploadImage(e,t,i){return Object(r.__awaiter)(this,void 0,void 0,function*(){const r=yield this.authService.retrieveConfig(),o=yield this.authService.retrieveCloudinary(r.cloudinary),c=new FormData,d=Math.round((new Date).getTime()/1e3),u=`${i}-${Object(n.a)()}`;c.append("file",e),c.append("timestamp",d.toString()),c.append("public_id",u),c.append("api_key",o.apiKey),c.append("signature",s(`public_id=${u}&timestamp=${d}${o.apiSecret}`).toString()),this.http.post(`https://api.cloudinary.com/v1_1/${o.asset}/image/upload`,c,{reportProgress:!0,observe:"events"}).subscribe(e=>{if(e instanceof a.c){if(this.isEdit)try{this.slackService.sendMsg(`Uploaded new image ${o.asset}: ${e.body.secure_url}`)}catch(i){}try{t.next(e.body.secure_url)}catch(i){}}else void 0!==e.loaded&&void 0!==e.total&&t.next(Math.round(100*e.loaded/e.total))})})}gifUploadImage(e,t){return Object(r.__awaiter)(this,void 0,void 0,function*(){const i=yield this.authService.retrieveConfig(),r=yield this.authService.retrieveImgurg(i.imgurg),n=new FormData;n.append("image",e),n.append("type","file"),this.http.post("https://api.imgur.com/3/image",n,{reportProgress:!0,observe:"events",headers:{authorization:`Client-ID ${r.clientId}`}}).subscribe(e=>{if(e instanceof a.c)try{const i=e.body.data;t.next(`${i.link}|${i.deletehash}`)}catch(i){}else void 0!==e.loaded&&void 0!==e.total&&t.next(Math.round(100*e.loaded/e.total))})})}uploadImage(e,t,i){const r=new c.a(0);return t?this.gifUploadImage(e,r):this.doUploadImage(e,r,Object(d.m)(i||"a")),r}removeImage(e,t){return Object(r.__awaiter)(this,void 0,void 0,function*(){return new Promise((i,n)=>Object(r.__awaiter)(this,void 0,void 0,function*(){const r=yield this.authService.retrieveCloudinary(t),n=new FormData,a=Math.round((new Date).getTime()/1e3);n.append("timestamp",a.toString()),n.append("public_id",e),n.append("api_key",r.apiKey),n.append("signature",s(`public_id=${e}&timestamp=${a}${r.apiSecret}`).toString());const o=this.http.post(`https://api.cloudinary.com/v1_1/${r.asset}/image/destroy`,n).subscribe(t=>{this.isEdit&&this.slackService.sendMsg(`Removed image ${r.asset}: ${e}`),i(),o.unsubscribe()})}))})}removeGifImage(e,t){return new Promise((i,n)=>Object(r.__awaiter)(this,void 0,void 0,function*(){const r=yield this.authService.retrieveImgurg(t),n=this.http.delete(`https://api.imgur.com/3/image/${e}`,{headers:{authorization:`Client-ID ${r.clientId}`}}).subscribe(e=>{i(),n.unsubscribe()})}))}}return e.\u0275fac=function(t){return new(t||e)(l.Zb(a.a),l.Zb(o.a),l.Zb(u.a))},e.\u0275prov=l.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},Gqa0:function(e,t,i){"use strict";i.d(t,"a",function(){return s});var r=i("mrSG"),n=i("oE1f"),a=i("N4yJ");class s{constructor(e){this.batch=e,this.array=[]}append(e){return this.array.push(e),this}run(){return Object(r.__awaiter)(this,void 0,void 0,function*(){if(0!==this.array.length){for(const e of this.array)switch(e.type){case n.a.Set:this.batch.set(e.doc,Object(a.n)(e.data));break;case n.a.Update:this.batch.update(e.doc,Object(a.n)(e.data));break;case n.a.Delete:this.batch.delete(e.doc)}return yield this.batch.commit(),!0}return!1})}}},JmXk:function(e,t,i){"use strict";i.d(t,"a",function(){return d});var r=i("mrSG"),n=i("i2ga"),a=i("wdqL"),s=i("i0WE"),o=i("8Y7J"),c=i("IheW");let d=(()=>{class e{constructor(e,t){this.http=e,this.authService=t,this.feedbackMap=new Map,this.totalFeedback=0}getAllPendingFeedbacks(e){return new Promise((t,i)=>Object(r.__awaiter)(this,void 0,void 0,function*(){if(this.feedbackMap.has(e))t([this.totalFeedback,this.feedbackMap.get(e)]);else{const i=yield this.authService.retrieveUser(),r=this.http.get(`${n.a.BASE_URL}${n.a.Feedbacks}`,{headers:{authorization:i.token}}).subscribe(i=>{const n=i.data.map(e=>{var t;return Object.assign(Object.assign({},e),{reason:(null===(t=a.a.Abuse.find(({id:t})=>t===e.reasonId))||void 0===t?void 0:t.content)||""})});this.feedbackMap.set(e,n),this.totalFeedback=i.total,t([i.total,n]),r.unsubscribe()},e=>{t([0,[]]),r.unsubscribe()})}}))}approveComment(e){return new Promise((t,i)=>Object(r.__awaiter)(this,void 0,void 0,function*(){const i=yield this.authService.retrieveUser(),r=this.http.delete(`${n.a.BASE_URL}${n.a.ApproveFeedback.replace(":id",e)}`,{headers:{authorization:i.token}}).subscribe(e=>{t(),r.unsubscribe()},e=>{t(),r.unsubscribe()})}))}rejectComment(e){return new Promise((t,i)=>Object(r.__awaiter)(this,void 0,void 0,function*(){const i=yield this.authService.retrieveUser(),r=this.http.delete(`${n.a.BASE_URL}${n.a.RejectFeedback.replace(":id",e)}`,{headers:{authorization:i.token}}).subscribe(e=>{t(),r.unsubscribe()},e=>{t(),r.unsubscribe()})}))}deleteComment(e,t){return new Promise((i,a)=>Object(r.__awaiter)(this,void 0,void 0,function*(){const r=yield this.authService.retrieveUser(),a=this.http.delete(`${n.a.BASE_URL}${n.a.DeleteComment.replace(":id",e).replace(":commentId",t)}`,{headers:{authorization:r.token}}).subscribe(e=>{i(),a.unsubscribe()},e=>{i(),a.unsubscribe()})}))}approve(e,t){return Object(r.__awaiter)(this,void 0,void 0,function*(){return this.feedbackMap.clear(),yield Promise.all([this.approveComment(t),this.deleteComment(e,t)]),this.getAllPendingFeedbacks(1)})}reject(e){return Object(r.__awaiter)(this,void 0,void 0,function*(){return this.feedbackMap.clear(),yield this.rejectComment(e),this.getAllPendingFeedbacks(1)})}}return e.\u0275fac=function(t){return new(t||e)(o.Zb(c.a),o.Zb(s.a))},e.\u0275prov=o.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},KM76:function(e,t,i){"use strict";i.d(t,"a",function(){return s});var r=i("i2ga"),n=i("8Y7J"),a=i("IheW");let s=(()=>{class e{constructor(e){this.http=e}sendMsg(e){const t=this.http.post(`${r.c.BASE_URL}${r.c.Noti}`,{text:e},{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).subscribe(e=>{t.unsubscribe()},e=>{t.unsubscribe()})}}return e.\u0275fac=function(t){return new(t||e)(n.Zb(a.a))},e.\u0275prov=n.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},N4yJ:function(e,t,i){"use strict";i.d(t,"g",function(){return a}),i.d(t,"d",function(){return o}),i.d(t,"a",function(){return c}),i.d(t,"b",function(){return d}),i.d(t,"c",function(){return u}),i.d(t,"n",function(){return l}),i.d(t,"e",function(){return h}),i.d(t,"j",function(){return b}),i.d(t,"i",function(){return p}),i.d(t,"o",function(){return f}),i.d(t,"m",function(){return v}),i.d(t,"h",function(){return m}),i.d(t,"k",function(){return w}),i.d(t,"l",function(){return y}),i.d(t,"f",function(){return _});var r=i("mrSG"),n=i("JZFu");function a(e,t){return new Promise((i,n)=>Object(r.__awaiter)(this,void 0,void 0,function*(){const n=new FileReader,a="string"==typeof e?yield function(e){return Object(r.__awaiter)(this,void 0,void 0,function*(){return(yield fetch(e)).blob()})}(e):void 0;n.onloadend=e=>{const r=new Image;r.src=n.result,r.onload=()=>{const e=r.width,n=r.height;if(t)i(r.width>r.height&&e>1e3?[s(r,1e3,1e3*n/e),e>n]:[a,r.width>r.height]);else{const t=r.width>r.height;i((r.width>r.height?r.width:r.height)>1500?[s(r,t?1500:1500*e/n,t?1500*n/e:1500),e>n]:[a,r.width>r.height])}}},n.readAsDataURL(a||e)}))}function s(e,t,i){const r=document.createElement("canvas");return r.width=t,r.height=i,r.getContext("2d").drawImage(e,0,0,t,i),function(e){if(-1==e.indexOf(";base64,")){const t=e.split(","),i=t[0].split(":")[1];return new Blob([t[1]],{type:i})}const t=e.split(";base64,"),i=t[0].split(":")[1],r=window.atob(t[1]),n=r.length,a=new Uint8Array(n);for(let s=0;s<n;++s)a[s]=r.charCodeAt(s);return new Blob([a],{type:i})}(r.toDataURL("image/png"))}function o(e){return e.replace("upload/","upload/q_auto:best/").replace(".jpg",".webp").replace(".jpeg",".webp").replace(".png",".webp")}function c(e){const t=e.split("/");return`https://${t[3]}.netifan.net/${t[t.length-1]}`.replace(".jpg",".jpeg").replace(".webp",".png")}function d(e){return c(e).replace(".jpeg",".webp").replace(".png",".webp")}function u(e){return e.replace(".webp",".png")}function l(e){let t={};return Object.keys(e).forEach(i=>{e[i]instanceof n.a.firestore.FieldValue&&(t=Object.assign(Object.assign({},t),{[i]:e[i]}))}),Object.assign(Object.assign({},JSON.parse(JSON.stringify(e))),t)}function h(e){return Array.from(Array(e.length).keys()).map(t=>e.slice(0,t+1))}function b(e){return void 0!==e.lastTime}function p(e){return void 0!==e.id}function f(e){return new Promise((t,i)=>Object(r.__awaiter)(this,void 0,void 0,function*(){setTimeout(()=>t(),e)}))}function v(e){let t="";for(let r=0;r<e.length;r++){const n=e.charAt(r);(i=n).match(/^[0-9a-zA-Z]+$/)||i in g?t+=n in g?g[n]:n:t+="-"}var i;return t=t.replace(/(-)+/g,"-"),"-"===t.charAt(t.length-1)&&(t=t.substring(0,t.length-1)),"-"===t.charAt(0)&&(t=t.substring(1)),t}const g={"\xe9":"e","\xe8":"e","\u1ebb":"e","\u1ebd":"e","\u1eb9":"e","\xea":"e","\u1ebf":"e","\u1ec1":"e","\u1ec3":"e","\u1ec5":"e","\u1ec7":"e","\xfd":"y","\u1ef3":"y","\u1ef7":"y","\u1ef9":"y","\u1ef5":"y","\xfa":"u","\xf9":"u","\u1ee7":"u","\u0169":"u","\u1ee5":"u","\u01b0":"u","\u1ee9":"u","\u1eeb":"u","\u1eed":"u","\u1eef":"u","\u1ef1":"u","\xed":"i","\xec":"i","\u1ec9":"i","\u0129":"i","\u1ecb":"i","\xf3":"o","\xf2":"o","\u1ecf":"o","\xf5":"o","\u1ecd":"o","\xf4":"o","\u1ed1":"o","\u1ed3":"o","\u1ed5":"o","\u1ed7":"o","\u1ed9":"o","\u01a1":"o","\u1edb":"o","\u1edd":"o","\u1edf":"o","\u1ee1":"o","\u1ee3":"o","\xe1":"a","\xe0":"a","\u1ea3":"a","\xe3":"a","\u1ea1":"a","\xe2":"a","\u1ea5":"a","\u1ea7":"a","\u1ea9":"a","\u1eab":"a","\u1ead":"a","\u0103":"a","\u1eaf":"a","\u1eb1":"a","\u1eb3":"a","\u1eb5":"a","\u1eb7":"a","\u0111":"d","\xc9":"E","\xc8":"E","\u1eba":"E","\u1ebc":"E","\u1eb8":"E","\xca":"E","\u1ebe":"E","\u1ec0":"E","\u1ec2":"E","\u1ec4":"E","\u1ec6":"E","\xdd":"Y","\u1ef2":"Y","\u1ef6":"Y","\u1ef8":"Y","\u1ef4":"Y","\xda":"U","\xd9":"U","\u1ee6":"U","\u0168":"U","\u1ee4":"U","\u01af":"U","\u1ee8":"U","\u1eea":"U","\u1eec":"U","\u1eee":"U","\u1ef0":"U","\xcd":"I","\xcc":"I","\u1ec8":"I","\u0128":"I","\u1eca":"I","\xd3":"O","\xd2":"O","\u1ece":"O","\xd5":"O","\u1ecc":"O","\xd4":"O","\u1ed0":"O","\u1ed2":"O","\u1ed4":"O","\u1ed6":"O","\u1ed8":"O","\u01a0":"O","\u1eda":"O","\u1edc":"O","\u1ede":"O","\u1ee0":"O","\u1ee2":"O","\xc1":"A","\xc0":"A","\u1ea2":"A","\xc3":"A","\u1ea0":"A","\xc2":"A","\u1ea4":"A","\u1ea6":"A","\u1ea8":"A","\u1eaa":"A","\u1eac":"A","\u0102":"A","\u1eae":"A","\u1eb0":"A","\u1eb2":"A","\u1eb4":"A","\u1eb6":"A","\u0110":"D"};function m(e){if(!e||!e.includes("youtube.com")&&!e.includes("youtu.be"))return;const t=e.match(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/);return t&&11===t[7].length?t[7]:void 0}function w(e){return"string"!=typeof e&&e.name.endsWith("gif")}function y(){const e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))&&0==e.toDataURL("image/webp").indexOf("data:image/webp")}function _(e){return new Promise((t,i)=>{const r=new FileReader;r.readAsDataURL(e),r.onload=function(){t(r.result.replaceAll("data:video/mp4;base64,",""))},r.onerror=function(e){t(void 0)}})}},Y3B2:function(e,t,i){"use strict";i.d(t,"a",function(){return r});class r{constructor(e,t,i){this.doc=e,this.type=t,this.data=i}}},Z93F:function(e,t,i){"use strict";i.d(t,"a",function(){return d});var r=i("mrSG"),n=i("i2ga"),a=i("N4yJ"),s=i("i0WE"),o=i("8Y7J"),c=i("IheW");let d=(()=>{class e{constructor(e,t){this.http=e,this.authService=t,this.canSupportWebP=Object(a.l)()}updateStage(e,t){return new Promise((i,a)=>Object(r.__awaiter)(this,void 0,void 0,function*(){const r=yield this.authService.retrieveUser(),a=this.http.put(`${n.a.BASE_URL}${n.a.Stage.replace(":id",e)}`,{stage:t},{headers:{authorization:r.token}}).subscribe(e=>{i(),a.unsubscribe()},e=>{i(),a.unsubscribe()})}))}updateSlider(e,t){return new Promise((i,a)=>Object(r.__awaiter)(this,void 0,void 0,function*(){const r=yield this.authService.retrieveUser(),a=this.http.put(`${n.a.BASE_URL}${n.a.Slider.replace(":id",e)}`,{slider:t},{headers:{authorization:r.token}}).subscribe(e=>{i(),a.unsubscribe()},e=>{i(),a.unsubscribe()})}))}updateFeatured(e,t){return new Promise((i,a)=>Object(r.__awaiter)(this,void 0,void 0,function*(){const r=yield this.authService.retrieveUser(),a=this.http.put(`${n.a.BASE_URL}${n.a.Featured.replace(":id",e)}`,{featured:t},{headers:{authorization:r.token}}).subscribe(e=>{i(),a.unsubscribe()},e=>{i(),a.unsubscribe()})}))}clearHtmlCache(){return new Promise((e,t)=>Object(r.__awaiter)(this,void 0,void 0,function*(){const t=yield this.authService.retrieveUser(),i=this.http.delete(`${n.a.BASE_URL}${n.a.ClearHtmlCache}`,{headers:{authorization:t.token}}).subscribe(t=>{e(!0),i.unsubscribe()},t=>{e(!1),i.unsubscribe()})}))}updateBackup(e,t){return new Promise((i,a)=>Object(r.__awaiter)(this,void 0,void 0,function*(){const r=yield this.authService.retrieveUser(),a=this.http.put(`${n.a.BASE_URL}${n.a.Backup.replace(":id",e)}`,{data:t},{headers:{authorization:r.token}}).subscribe(e=>{i(!0),a.unsubscribe()},e=>{i(!1),a.unsubscribe()})}))}}return e.\u0275fac=function(t){return new(t||e)(o.Zb(c.a),o.Zb(s.a))},e.\u0275prov=o.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},d2mR:function(e,t,i){"use strict";i.d(t,"a",function(){return a});var r=i("SVse"),n=i("8Y7J");let a=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.Nb({type:e}),e.\u0275inj=n.Mb({imports:[[r.c],r.c]}),e})()},i0WE:function(e,t,i){"use strict";i.d(t,"a",function(){return h});var r=i("mrSG"),n=i("2Vo4"),a=i("i2ga"),s=i("N4yJ"),o=i("8Y7J"),c=i("wD+u"),d=i("VRCc"),u=i("LC/r"),l=i("IheW");let h=(()=>{class e{constructor(e,t,i,r){this.afs=e,this.afAuth=t,this.aRC=i,this.http=r,this.firebaseUser=null,this.userChanges=new n.a(void 0)}getValidTime(){return Object(r.__awaiter)(this,void 0,void 0,function*(){return void 0!==this.isTimeValid?this.isTimeValid:(yield Object(s.o)(50),this.getValidTime())})}retrieveConfig(){return Object(r.__awaiter)(this,void 0,void 0,function*(){return this.config||((yield this.aRC.settings).minimumFetchIntervalMillis=18e5,yield this.aRC.fetchAndActivate(),this.config={cloudinary:yield this.aRC.getString("cloudinary"),imgurg:yield this.aRC.getString("imgurg")}),this.config})}retrieveCloudinary(e){return new Promise((t,i)=>Object(r.__awaiter)(this,void 0,void 0,function*(){this.cloudinary||(yield this.fetchCredential()),t(this.cloudinary[e])}))}retrieveImgurg(e){return new Promise((t,i)=>Object(r.__awaiter)(this,void 0,void 0,function*(){this.imgurg||(yield this.fetchCredential()),t(this.imgurg[e])}))}fetchCredential(){return new Promise((e,t)=>Object(r.__awaiter)(this,void 0,void 0,function*(){this.http.get(`${a.d.BASE_URL}${a.d.Credential}`,{headers:{"x-key":"hxLCPL8BuV"}}).subscribe(t=>{this.cloudinary=t.service.cloudinary,this.imgurg=t.service.imgurg,this.isTimeValid=Math.abs(t.time-(new Date).getTime())<=3e3,this.tokenGit=t.git,e()})}))}retrieveUser(){return this.cloudinary&&this.imgurg||this.fetchCredential(),new Promise((e,t)=>Object(r.__awaiter)(this,void 0,void 0,function*(){if(this.user&&this.firebaseUser){const t=yield this.firebaseUser.getIdToken(!0);this.user.token=t,e(this.user)}else{const t=this.afAuth.authState.subscribe(i=>{if(i){const t=this.afs.collection("users").doc(i.uid).get().subscribe(n=>Object(r.__awaiter)(this,void 0,void 0,function*(){this.firebaseUser=i,this.update(Object.assign(Object.assign({},n.data()),{id:i.uid,token:yield i.getIdToken(!0)})),e(this.user),t.unsubscribe()}))}else e(void 0);t.unsubscribe()})}}))}retrieveUserByIds(e){return Object(r.__awaiter)(this,void 0,void 0,function*(){let t={};return(yield Promise.all(e.map(e=>this.retrieveUserById(e)))).forEach((i,r)=>{i&&(t=Object.assign(Object.assign({},t),{[e[r]]:i}))}),t})}retrieveAllUsers(){return new Promise((e,t)=>Object(r.__awaiter)(this,void 0,void 0,function*(){if(this.allUsers)e(this.allUsers);else{const t=yield this.afs.collection("users").ref.get(),i=[];t.forEach(e=>{i.push(Object.assign(Object.assign({},e.data()),{id:e.id}))}),this.allUsers=i,e(i)}}))}retrieveUserById(e){return new Promise((t,i)=>Object(r.__awaiter)(this,void 0,void 0,function*(){const i=this.afs.collection("users").doc(e).get().subscribe(e=>{t(e.data()),i.unsubscribe()})}))}login(e,t){return new Promise((i,n)=>Object(r.__awaiter)(this,void 0,void 0,function*(){try{const n=yield this.afAuth.signInWithEmailAndPassword(e,t);this.afs.collection("users").doc(n.user.uid).get().subscribe(e=>Object(r.__awaiter)(this,void 0,void 0,function*(){this.firebaseUser=n.user,this.update(Object.assign(Object.assign({},e.data()),{id:n.user.uid,token:yield n.user.getIdToken()})),i(!0)}))}catch(n){i(!1)}}))}logout(){return Object(r.__awaiter)(this,void 0,void 0,function*(){this.update(void 0),this.firebaseUser=null,yield this.afAuth.signOut()})}update(e){this.user=e,this.userChanges.next(e)}}return e.\u0275fac=function(t){return new(t||e)(o.Zb(c.a),o.Zb(d.a),o.Zb(u.a),o.Zb(l.a))},e.\u0275prov=o.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},i2ga:function(e,t,i){"use strict";i.d(t,"a",function(){return r}),i.d(t,"b",function(){return n}),i.d(t,"d",function(){return a}),i.d(t,"c",function(){return s});const r={BASE_URL:"https://backup.netifan.net",Category:"/public/v1/category",Post:"/admin/v1/article",GetArticle:"/admin/v1/article/:id",Articles:"/admin/v1/articles",Feedbacks:"/admin/v1/feedbacks",ApproveFeedback:"/admin/v1/feedback/approve/comment/:id",RejectFeedback:"/admin/v1/feedback/reject/comment/:id",DeleteComment:"/admin/v1/article/:id/comment/:commentId",Stage:"/admin/v1/stage/article/:id",Slider:"/admin/v1/slider/article/:id",Featured:"/admin/v1/featured/article/:id",ClearHtmlCache:"/admin/v1/html",Backup:"/admin/v1/article/:id/backup-url"},n={MAIN_BASE_URL:"https://api.netifan.net",Product:"/public/v1/article/:id"},a={BASE_URL:"https://config.netifan.workers.dev",Credential:"/credential"},s={BASE_URL:"https://hooks.slack.com",Noti:"/services/T0220EW16TC/B03N8AG3Q14/mOuJ7LLzPciyMaIkioQdqUwh"}},kLt5:function(e,t,i){"use strict";i.d(t,"a",function(){return b});var r=i("mrSG"),n=i("2Vo4"),a=i("l5mm"),s=i("6eBy"),o=i("oE1f"),c=i("Y3B2"),d=i("Gqa0"),u=i("N4yJ"),l=i("8Y7J"),h=i("wD+u");let b=(()=>{class e{constructor(e){this.afs=e,this.tagChanges=new n.a([]),this.valueChanges=new n.a(""),this.valueChanges.pipe(Object(s.a)(()=>Object(a.a)(1e3))).subscribe(e=>this.getData(e))}getSuggestion(e){this.valueChanges.next(e)}getData(e){return Object(r.__awaiter)(this,void 0,void 0,function*(){if(e){const t=yield this.afs.collection("tags").ref.where("keys","array-contains-any",[e.toLowerCase().trim()]).limit(5).get();let i=[];t.forEach(e=>{try{i=[...i,...e.data().name]}catch(t){}}),this.tagChanges.next(i)}else this.tagChanges.next([])})}getTagByName(e){return Object(r.__awaiter)(this,void 0,void 0,function*(){return new Promise((t,i)=>Object(r.__awaiter)(this,void 0,void 0,function*(){this.afs.collection("tags").doc(e.toLowerCase()).get().subscribe(i=>{t(i.exists?[e,i.data().name]:[e,void 0])})}))})}addSuggestion(e){return Object(r.__awaiter)(this,void 0,void 0,function*(){if(e.length>0){const t=yield Promise.all(e.map(e=>this.getTagByName(e))),i=new d.a(this.afs.firestore.batch());for(const e of t){const[t,r]=e;r?r.includes(t)||i.append(new c.a(this.afs.collection("tags").doc(t.toLowerCase()).ref,o.a.Update,{name:[...r,t]})):i.append(new c.a(this.afs.collection("tags").doc(t.toLowerCase()).ref,o.a.Set,{keys:Object(u.e)(t.toLowerCase()),name:[t]}))}yield i.run()}})}}return e.\u0275fac=function(t){return new(t||e)(l.Zb(h.a))},e.\u0275prov=l.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},oE1f:function(e,t,i){"use strict";i.d(t,"c",function(){return r}),i.d(t,"a",function(){return n}),i.d(t,"b",function(){return a});var r=function(e){return e.Pending="pending",e.Approved="approved",e}({}),n=function(e){return e[e.Set=0]="Set",e[e.Update=1]="Update",e[e.Delete=2]="Delete",e}({}),a=function(e){return e[e.Stage=0]="Stage",e[e.Slider=1]="Slider",e[e.Featured=2]="Featured",e}({})},qPgb:function(e,t,i){"use strict";i.d(t,"a",function(){return v});var r=i("mrSG"),n=i("i0WE"),a=i("JZFu"),s=i("Gqa0"),o=i("Y3B2"),c=i("oE1f"),d=i("9ko8"),u=i("i2ga"),l=i("wdqL"),h=i("8Y7J"),b=i("wD+u"),p=i("IheW"),f=i("iInd");let v=(()=>{class e{constructor(e,t,i,r,n){this.afs=e,this.http=t,this.authService=i,this.imageService=r,this.router=n,this.totalApproved=0,this.approvedMap=new Map}getCategories(){return new Promise((e,t)=>{if(this.categories)e(this.categories);else{const t=this.http.get(`${u.a.BASE_URL}${u.a.Category}`).subscribe(i=>{this.categories=i.data,e(this.categories),t.unsubscribe()})}})}extractTags(e){return this.draft?e.filter(e=>!this.draft[1].tags.includes(e)):e}updateMainImage(e){return Object(r.__awaiter)(this,void 0,void 0,function*(){if(this.draft){const[t,i]=this.draft,r={url:e,provider:(yield this.authService.retrieveConfig()).cloudinary};yield this.afs.collection("drafts").doc(t).update({image:r}),i.image=r}})}getArticleById(e){return new Promise((t,i)=>Object(r.__awaiter)(this,void 0,void 0,function*(){const i=this.http.get(`${u.a.BASE_URL}${u.a.GetArticle.replace(":id",e)}`,{headers:{authorization:(yield this.authService.retrieveUser()).token}}).subscribe(e=>{this.article=e.data,t(this.article),i.unsubscribe()},e=>{t(void 0)})}))}getDraftById(e){return new Promise((t,i)=>Object(r.__awaiter)(this,void 0,void 0,function*(){const i=this.afs.collection("drafts").doc(e).get().subscribe(e=>Object(r.__awaiter)(this,void 0,void 0,function*(){if(e.exists){const i=e.data(),r=yield this.authService.retrieveUser();!i.review&&i.owner===r.id||i.review&&r.isAdmin?(this.draft=[e.id,i],t(i)):t(void 0)}i.unsubscribe()}))}))}getAllDrafts(){return Object(r.__awaiter)(this,void 0,void 0,function*(){if(this.drafts)return this.drafts;try{const e=yield this.afs.collection("drafts").ref.where("owner","==",(yield this.authService.retrieveUser()).id).where("review","==",null).orderBy("lastTime","desc").get(),t=[];return e.forEach(e=>{t.push([e.id,e.data()])}),this.drafts=t,t}catch(e){return[]}})}getAllPendings(){return Object(r.__awaiter)(this,void 0,void 0,function*(){if(this.pending)return this.pending;try{const e=yield this.authService.retrieveUser(),t=e.isAdmin?yield this.afs.collection("drafts").ref.where("review","!=",null).get():yield this.afs.collection("drafts").ref.where("owner","==",e.id).where("review","!=",null).get(),i=[];if(t.forEach(e=>{i.push([e.id,e.data()])}),e.isAdmin){const e=yield this.authService.retrieveUserByIds(Array.from(new Set(i.map(([,e])=>e.owner))));i.forEach(([,t])=>{t.owner in e&&(t.ownerName=e[t.owner].name)})}return this.pending=i.sort(([,e],[,t])=>t.lastTime.toMillis()-e.lastTime.toMillis()),this.pending}catch(e){return[]}})}getBlockById(e){return Object(r.__awaiter)(this,void 0,void 0,function*(){return new Promise((t,i)=>Object(r.__awaiter)(this,void 0,void 0,function*(){const i=this.afs.collection("blocks").doc(e).get().subscribe(e=>{t(e.data()),i.unsubscribe()})}))})}getBlocksByIds(e){return Object(r.__awaiter)(this,void 0,void 0,function*(){return(yield Promise.all(e.map(e=>this.getBlockById(e)))).map((t,i)=>Object.assign(Object.assign(Object.assign({},t),{id:e[i],showRemove:!0}),"Video"===t.type&&t.youtubeCacheLink?{youtubeCacheLink:`https://www.youtube.com/watch?v=${t.youtubeCacheLink}`}:{}))})}createBlock(e){return Object(r.__awaiter)(this,void 0,void 0,function*(){const t=Object(r.__rest)(e,["id","isChangedHtml"]);return(yield this.afs.collection("blocks").add(t)).id})}removeBlock(e){return Object(r.__awaiter)(this,void 0,void 0,function*(){if(this.draft){const[t,i]=this.draft,r=i.blocks.filter(t=>t!==e);yield new s.a(this.afs.firestore.batch()).append(new o.a(this.afs.collection("drafts").doc(t).ref,c.a.Update,{blocks:r,lastTime:a.a.firestore.FieldValue.serverTimestamp()})).append(new o.a(this.afs.collection("blocks").doc(e).ref,c.a.Delete)).run(),this.draft[1].blocks=r}})}addBlocks(e){return Object(r.__awaiter)(this,void 0,void 0,function*(){if(this.draft){const[t,i]=this.draft,r=[...i.blocks,...e];yield this.afs.collection("drafts").doc(t).update({blocks:r,lastTime:a.a.firestore.FieldValue.serverTimestamp()}),i.blocks=r}})}addVideoBlock(e,t){return Object(r.__awaiter)(this,void 0,void 0,function*(){if(this.draft){const[i,r]=this.draft,n=yield this.createBlock(e),d=t?[...r.blocks.filter(e=>e!==t),n]:[...r.blocks,n],u=new s.a(this.afs.firestore.batch()).append(new o.a(this.afs.collection("drafts").doc(i).ref,c.a.Update,{blocks:d,lastTime:a.a.firestore.FieldValue.serverTimestamp()}));return t&&u.append(new o.a(this.afs.collection("blocks").doc(t).ref,c.a.Delete)),yield u.run(),this.draft[1].blocks=d,n}})}saveDraft(e,t,i,n,a,s,o,c){return Object(r.__awaiter)(this,void 0,void 0,function*(){if(this.draft){const[r,s]=this.draft;yield this.saveOldDraft(r,s,e,t,i,n,a,o,c)}else yield this.saveNewDraft(e,t,i,n,a,s,o,c);this.router.navigateByUrl(c?"posts/pending":"/posts/draft")})}saveOldDraft(e,t,i,n,d,u,l,h,b){return Object(r.__awaiter)(this,void 0,void 0,function*(){const r=h.map(e=>e.id),p=h.filter(e=>!t.blocks.includes(e.id)),f=h.filter(e=>t.blocks.includes(e.id)&&e.isChangedHtml),v=t.blocks.filter(e=>!r.includes(e)),g=p.length>0?yield Promise.all(p.map(e=>this.createBlock(e))):[];p.forEach((e,t)=>e.id=g[t]);const m=new s.a(this.afs.firestore.batch());f.length>0&&f.forEach(e=>m.append(new o.a(this.afs.collection("blocks").doc(e.id).ref,c.a.Update,{html:e.html}))),v.length>0&&v.forEach(e=>m.append(new o.a(this.afs.collection("blocks").doc(e).ref,c.a.Delete)));let w={lastTime:a.a.firestore.FieldValue.serverTimestamp()};i!==t.categoryId&&(w=Object.assign(Object.assign({},w),{categoryId:i})),n!==t.title&&(w=Object.assign(Object.assign({},w),{title:n})),d!==t.link&&(w=Object.assign(Object.assign({},w),{link:d||a.a.firestore.FieldValue.delete()})),u!==t.description&&(w=Object.assign(Object.assign({},w),{description:u||a.a.firestore.FieldValue.delete()})),l.join(",")!==t.tags.join(",")&&(w=Object.assign(Object.assign({},w),{tags:l}));const y=h.map(e=>e.id);(y.join(",")!==t.blocks.join(",")||p.length>0||f.length>0||v.length>0)&&(w=Object.assign(Object.assign({},w),{blocks:y})),(b&&!t.review||!b&&t.review)&&(w=Object.assign(Object.assign({},w),{review:b||null})),Object.keys(w).length>1&&m.append(new o.a(this.afs.collection("drafts").doc(e).ref,c.a.Update,w)),(yield m.run())&&(this.pending=void 0,this.drafts=void 0)})}saveNewDraft(e,t,i,n,s,o,c,d){return Object(r.__awaiter)(this,void 0,void 0,function*(){const r=yield Promise.all(c.map(e=>this.createBlock(e)));yield this.afs.collection("drafts").add(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({owner:(yield this.authService.retrieveUser()).id,lastTime:a.a.firestore.FieldValue.serverTimestamp(),categoryId:e,title:t},i?{link:i}:{}),n?{description:n}:{}),{tags:s}),o?{image:{url:o,provider:(yield this.authService.retrieveConfig()).cloudinary}}:{}),{blocks:r,review:d||null})),this.pending=void 0,this.drafts=void 0})}removeDraftOrArticle(e,t,i,n,a){return Object(r.__awaiter)(this,void 0,void 0,function*(){if(this.article&&!(yield this.deleteArticle(this.article.id)))return!1;let r=[],s=[];if(e.forEach((e,t)=>{if(e.hash)s=[...s,[e.provider,e.hash]];else{const i=t.split("/");r=[...r,[e.provider,i[i.length-1].replace(".jpg","").replace(".jpeg","").replace(".png","").replace(".webp","")]]}}),a&&!e.has(a.url)){const e=a.url.split("/");r=[...r,[a.provider,e[e.length-1].replace(".jpg","").replace(".jpeg","").replace(".png","").replace(".webp","")]]}return t.forEach(t=>{if(!e.has(t.url)&&t.url&&t.provider)if(t.hash)s=[...s,[t.provider,t.hash]];else{const e=t.url.split("/");r=[...r,[t.provider,e[e.length-1].replace(".jpg","").replace(".jpeg","").replace(".png","").replace(".webp","")]]}}),yield Promise.all([...n&&n.videoLink&&n.shaGit?[this.imageService.removeVideo(n.videoLink.match(/[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}/g)[0],n.shaGit)]:[],...!i||n&&n.videoLink===i[0]?[]:[this.imageService.removeVideo(i[0].match(/[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}/g)[0],i[1])],...r.map(([e,t])=>this.imageService.removeImage(t,e)),...s.map(([e,t])=>this.imageService.removeGifImage(t,e)),...this.draft?[this.deleteDraft(this.draft[0],this.draft[1].blocks).run()]:[]]),this.draft?(this.drafts=void 0,this.router.navigateByUrl("/posts/draft")):this.article&&(this.article=void 0,this.approvedMap.clear(),this.router.navigateByUrl("/posts/approved")),!0})}deleteArticle(e){return new Promise((t,i)=>Object(r.__awaiter)(this,void 0,void 0,function*(){const i=this.http.delete(`${u.a.BASE_URL}${u.a.GetArticle.replace(":id",e)}`,{headers:{authorization:(yield this.authService.retrieveUser()).token}}).subscribe(e=>{t(!0),i.unsubscribe()},e=>{t(!1),i.unsubscribe()})}))}deleteDraft(e,t){const i=new s.a(this.afs.firestore.batch()).append(new o.a(this.afs.collection("drafts").doc(e).ref,c.a.Delete));return t.forEach(e=>{i.append(new o.a(this.afs.collection("blocks").doc(e).ref,c.a.Delete))}),i}removeCurrentDraft(){return Object(r.__awaiter)(this,void 0,void 0,function*(){if(this.draft){const[e,t]=this.draft;(yield this.deleteDraft(e,t.blocks).run())&&(this.pending=void 0,this.drafts=void 0,this.draft=void 0)}this.approvedMap.clear()})}removeCurrentArticle(){this.article=void 0,this.approvedMap.clear(),this.approvedMap.clear()}rejectDraft(){return Object(r.__awaiter)(this,void 0,void 0,function*(){if(this.draft){const[e]=this.draft;yield this.afs.collection("drafts").doc(e).update({review:null}),this.pending=void 0,this.router.navigateByUrl("posts/pending")}})}approve(e,t,i,n,a,s,o,c){return new Promise((d,l)=>Object(r.__awaiter)(this,void 0,void 0,function*(){const r=yield this.authService.retrieveUser(),l=this.http.post(`${u.a.BASE_URL}${u.a.Post}`,{categoryId:e,link:i,title:t,description:n,tags:a,mainImage:s,blocks:o,review:c,owner:this.draft?this.draft[1].owner:r.id},{headers:{authorization:r.token}}).subscribe(e=>{d(e.data),l.unsubscribe()},e=>{d(void 0),l.unsubscribe()})}))}getAllApproved(e,t,i,n,a,s,o){return new Promise((c,d)=>Object(r.__awaiter)(this,void 0,void 0,function*(){if(e&&this.approvedMap.clear(),this.approvedMap.has(t))c([this.totalApproved,this.approvedMap.get(t)]);else{const e=this.http.get(`${u.a.BASE_URL}${u.a.Articles}`,{headers:{authorization:(yield this.authService.retrieveUser()).token},params:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({perPage:l.a.PER_PAGE.toString(),page:t.toString()},i?{keyword:i.toString()}:{}),n?{fromDate:n.toISOString()}:{}),a?{toDate:a.toISOString()}:{}),s?{owner:s.toString()}:{}),o?{categoryId:o.toString()}:{})}).subscribe(i=>{const r=i.data;this.approvedMap.set(t,r),this.totalApproved=i.total,c([i.total,r]),e.unsubscribe()},t=>{c([0,[]]),e.unsubscribe()})}}))}updateArticle(e,t,i,n,a,s,o,c){return Object(r.__awaiter)(this,void 0,void 0,function*(){let r=[],d=[];o.forEach((e,t)=>{if(t!==a.url&&s.every(e=>e.url!==t))if(e.hash)d=[...d,[e.provider,e.hash]];else{const i=t.split("/");r=[...r,[e.provider,i[i.length-1].replace(".jpg","").replace(".jpeg","").replace(".png","").replace(".webp","")]]}});const u=s.find(e=>"video"===e.type),[l]=yield Promise.all([this.edit(e,t,i,n,a,s),...!c||u&&u.videoLink===c[0]?[]:[this.imageService.removeVideo(c[0].match(/[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}/g)[0],c[1])],...r.map(([e,t])=>this.imageService.removeImage(t,e)),...d.map(([e,t])=>this.imageService.removeGifImage(t,e))]);return l})}edit(e,t,i,n,a,s){return new Promise((o,c)=>Object(r.__awaiter)(this,void 0,void 0,function*(){if(!this.article||e===this.article.title&&t===this.article.link&&i===this.article.description&&n.join(",")===this.article.tags.join(",")&&a.url===this.article.mainImage.url&&JSON.stringify(s)===JSON.stringify(this.article.blocks))o(void 0);else{const r=yield this.authService.retrieveUser(),c=this.http.patch(`${u.a.BASE_URL}${u.a.GetArticle.replace(":id",this.article.id)}`,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e!==this.article.title?{title:e}:{}),t!==this.article.link?{link:t}:{}),i!==this.article.description?{description:i}:{}),n.join(",")!==this.article.tags.join(",")?{tags:n}:{}),a.url!==this.article.mainImage.url?{mainImage:a}:{}),JSON.stringify(s)!==JSON.stringify(this.article.blocks)?{blocks:s}:{}),{headers:{authorization:r.token}}).subscribe(e=>{o(!0),c.unsubscribe()},e=>{o(!1),c.unsubscribe()})}}))}prefetch(e){const t=this.http.get(`${u.b.MAIN_BASE_URL}${u.b.Product.replace(":id",e)}`).subscribe(e=>{t.unsubscribe()},e=>{t.unsubscribe()})}}return e.\u0275fac=function(t){return new(t||e)(h.Zb(b.a),h.Zb(p.a),h.Zb(n.a),h.Zb(d.a),h.Zb(f.c))},e.\u0275prov=h.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},wdqL:function(e,t,i){"use strict";i.d(t,"a",function(){return r});let r=(()=>{class e{}return e.PER_PAGE=10,e.Abuse=[{id:1,content:"B\xecnh lu\u1eadn c\xf3 n\u1ed9i dung kh\xf4ng th\xedch h\u1ee3p"},{id:2,content:"N\u1ed9i dung qu\u1ea3ng c\xe1o kh\xf4ng mong mu\u1ed1n"},{id:3,content:"T\xe0i li\u1ec7u khi\xeau d\xe2m ho\u1eb7c phim khi\xeau d\xe2m"},{id:4,content:"X\xe2m h\u1ea1i tr\u1ebb em"},{id:5,content:"L\u1eddi n\xf3i c\u0103m th\xf9 ho\u1eb7c h\xecnh \u1ea3nh b\u1ea1o l\u1ef1c"},{id:6,content:"Qu\u1ea5y r\u1ed1i ho\u1eb7c b\u1eaft n\u1ea1t"}],e})()},zUnb:function(e,t,i){"use strict";i.r(t);var r=i("cUpR"),n=i("8Y7J"),a=i("SVse"),s=i("omvX"),o=i("aLe/"),c=i("rVqu"),d=i("iInd"),u=i("dgaq");let l=(()=>{class e{constructor(e,t,i,r){this.router=e,this.iconSet=t,this.activatedRoute=i,this.titleService=r,t.icons=Object.assign({},u.a)}ngOnInit(){this.router.events.subscribe(e=>{e instanceof d.b&&(this.getChild(this.activatedRoute).data.subscribe(e=>this.titleService.setTitle(`Admin - ${e.title}`)),window.scrollTo(0,0))})}getChild(e){return e.firstChild?this.getChild(e.firstChild):e}}return e.\u0275fac=function(t){return new(t||e)(n.Pb(d.c),n.Pb(c.c),n.Pb(d.a),n.Pb(r.c))},e.\u0275cmp=n.Jb({type:e,selectors:[["body"]],features:[n.Cb([c.c])],decls:1,vars:0,template:function(e,t){1&e&&n.Qb(0,"router-outlet")},directives:[d.h],encapsulation:2}),e})();var h=i("mrSG"),b=i("i0WE");const p=[{title:!0,name:"T\u1ed5ng k\u1ebft"},{name:"Trang ch\u1ee7",url:"/",icon:"icon-home"},{title:!0,name:"B\xe0i vi\u1ebft"},{name:"Th\xeam b\xe0i vi\u1ebft",url:"/create",icon:"icon-plus"},{name:"Nh\xe1p",url:"/posts/draft",icon:"icon-doc"},{name:"Ch\u1edd duy\u1ec7t",url:"/posts/pending",icon:"icon-directions"},{name:"\u0110\xe3 duy\u1ec7t",url:"/posts/approved",icon:"icon-list"},{name:"B\xe1o x\u1ea5u",url:"/banned",icon:"icon-ban"}],f=[{title:!0,name:"T\u1ed5ng k\u1ebft"},{name:"Trang ch\u1ee7",url:"/",icon:"icon-home"},{title:!0,name:"B\xe0i vi\u1ebft"},{name:"Th\xeam b\xe0i vi\u1ebft",url:"/create",icon:"icon-plus"},{name:"Nh\xe1p",url:"/posts/draft",icon:"icon-doc"},{name:"Ch\u1edd duy\u1ec7t",url:"/posts/pending",icon:"icon-directions"},{name:"\u0110\xe3 duy\u1ec7t",url:"/posts/approved",icon:"icon-list"}];var v=i("Iluq"),g=i("FE24");function m(e,t){if(1&e){const e=n.Wb();n.Vb(0,"div",12),n.Vb(1,"div",13),n.Vb(2,"strong"),n.Fc(3,"T\xe0i kho\u1ea3n"),n.Ub(),n.Ub(),n.Vb(4,"a",14),n.cc("click",function(){return n.wc(e),n.fc().signout()}),n.Qb(5,"i",15),n.Fc(6," \u0110\u0103ng xu\u1ea5t"),n.Ub(),n.Ub()}}const w=function(){return["/"]},y=function(){return{src:"assets/img/brand/logo.svg",width:89,height:25,alt:"CoreUI Logo"}},_=function(){return{src:"assets/img/brand/sygnet.svg",width:30,height:30,alt:"CoreUI Logo"}};let k=(()=>{class e{constructor(e,t){this.authService=e,this.router=t,this.sidebarMinimized=!1,this.navItems=p,this.authService.userChanges.subscribe(e=>{this.name=e&&e.name?e.name:"",e?(this.name=e.name,this.navItems=e.isAdmin?p:f):this.name=""})}toggleMinimize(e){this.sidebarMinimized=e}signout(){return Object(h.__awaiter)(this,void 0,void 0,function*(){yield this.authService.logout(),this.router.navigateByUrl("/login")})}}return e.\u0275fac=function(t){return new(t||e)(n.Pb(b.a),n.Pb(d.c))},e.\u0275cmp=n.Jb({type:e,selectors:[["app-dashboard"]],decls:17,vars:15,consts:[[3,"navbarBrandRouterLink","fixed","navbarBrandFull","navbarBrandMinimized","sidebarToggler","asideMenuToggler"],[1,"nav","navbar-nav","ml-auto",2,"margin-right","20px"],["dropdown","","placement","bottom right",1,"nav-item","dropdown"],["data-toggle","dropdown","href","#","role","button","aria-haspopup","true","aria-expanded","false","dropdownToggle","",1,"nav-link",3,"click"],[2,"font-weight","bold","color","black"],["class","dropdown-menu dropdown-menu-right","aria-labelledby","simple-dropdown",4,"dropdownMenu"],[1,"app-body"],[3,"fixed","display","minimized","minimizedChange"],["appSidebar",""],[3,"navItems","perfectScrollbar","disabled"],[1,"main"],[1,"container-fluid"],["aria-labelledby","simple-dropdown",1,"dropdown-menu","dropdown-menu-right"],[1,"dropdown-header","text-center"],["href","#",1,"dropdown-item",3,"click"],[1,"fa","fa-lock"]],template:function(e,t){if(1&e&&(n.Vb(0,"app-header",0),n.Vb(1,"ul",1),n.Vb(2,"div"),n.Fc(3,"Xin ch\xe0o\xa0"),n.Ub(),n.Vb(4,"li",2),n.Vb(5,"a",3),n.cc("click",function(){return!1}),n.Vb(6,"div",4),n.Fc(7),n.Ub(),n.Ub(),n.Dc(8,m,7,0,"div",5),n.Ub(),n.Ub(),n.Ub(),n.Vb(9,"div",6),n.Vb(10,"app-sidebar",7,8),n.cc("minimizedChange",function(e){return t.toggleMinimize(e)}),n.Qb(12,"app-sidebar-nav",9),n.Qb(13,"app-sidebar-minimizer"),n.Ub(),n.Vb(14,"main",10),n.Vb(15,"div",11),n.Qb(16,"router-outlet"),n.Ub(),n.Ub(),n.Ub()),2&e){const e=n.tc(11);n.lc("navbarBrandRouterLink",n.oc(12,w))("fixed",!0)("navbarBrandFull",n.oc(13,y))("navbarBrandMinimized",n.oc(14,_))("sidebarToggler","lg")("asideMenuToggler",!1),n.Db(7),n.Gc(t.name),n.Db(3),n.lc("fixed",!0)("display","lg")("minimized",t.sidebarMinimized),n.Db(2),n.lc("navItems",t.navItems)("disabled",e.minimized)}},directives:[v.c,g.a,g.d,g.b,v.e,v.h,o.a,v.f,d.h],encapsulation:2}),e})();var O=i("VRCc"),j=i("CNMR");let U=(()=>{class e{constructor(e,t){this.router=e,this.authService=t}check(e){return Object(h.__awaiter)(this,void 0,void 0,function*(){const t=yield this.authService.retrieveUser();return t?!(["/banned","/secret"].includes(e)&&!t.isAdmin&&(this.router.navigateByUrl("/"),1)):(this.router.navigateByUrl("/login"),!1)})}canActivate(e,t){return this.check(t.url)}}return e.\u0275fac=function(t){return new(t||e)(n.Zb(d.c),n.Zb(b.a))},e.\u0275prov=n.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),S=(()=>{class e{constructor(e,t){this.router=e,this.authService=t}check(){return Object(h.__awaiter)(this,void 0,void 0,function*(){return!(yield this.authService.retrieveUser())||(this.router.navigateByUrl("/"),!1)})}canActivate(e,t){return this.check()}}return e.\u0275fac=function(t){return new(t||e)(n.Zb(d.c),n.Zb(b.a))},e.\u0275prov=n.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),A=(()=>{class e{constructor(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Jb({type:e,selectors:[["ng-component"]],decls:11,vars:0,consts:[[1,"app","flex-row","align-items-center"],[1,"container"],[1,"row","justify-content-center"],[1,"col-md-6"],[1,"clearfix"],[1,"float-left","display-3","mr-4"],[1,"pt-3"],[1,"text-muted"]],template:function(e,t){1&e&&(n.Vb(0,"div",0),n.Vb(1,"div",1),n.Vb(2,"div",2),n.Vb(3,"div",3),n.Vb(4,"div",4),n.Vb(5,"h1",5),n.Fc(6,"404"),n.Ub(),n.Vb(7,"h4",6),n.Fc(8,"Oops! You're lost."),n.Ub(),n.Vb(9,"p",7),n.Fc(10,"The page you are looking for was not found."),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub())},encapsulation:2}),e})();const I=["email"],C=["pass"];function B(e,t){if(1&e&&(n.Vb(0,"alert",21),n.Fc(1),n.Ub()),2&e){const e=n.fc();n.Db(1),n.Hc(" ",e.error," ")}}const P=[{path:"login",component:(()=>{class e{constructor(e,t){this.authService=e,this.router=t,this.isLoading=!1}login(){return Object(h.__awaiter)(this,void 0,void 0,function*(){this.isLoading=!0,(yield this.authService.login(this.email.nativeElement.value,this.pass.nativeElement.value))?this.router.navigateByUrl("/"):(this.error="Email ho\u1eb7c m\u1eadt kh\u1ea9u kh\xf4ng \u0111\xfang",this.isLoading=!1)})}}return e.\u0275fac=function(t){return new(t||e)(n.Pb(b.a),n.Pb(d.c))},e.\u0275cmp=n.Jb({type:e,selectors:[["app-dashboard"]],viewQuery:function(e,t){if(1&e&&(n.Ic(I,1),n.Ic(C,1)),2&e){let e;n.sc(e=n.dc())&&(t.email=e.first),n.sc(e=n.dc())&&(t.pass=e.first)}},decls:28,vars:2,consts:[[1,"app-body"],[1,"main","d-flex","align-items-center"],[1,"container"],[1,"row"],["id","box",1,"mx-auto"],[1,"card"],[1,"card-body"],[1,"text-muted"],[1,"input-group","mb-3"],[1,"input-group-prepend"],[1,"input-group-text"],[1,"icon-user"],["type","text","placeholder","Email","autocomplete","username","required","",1,"form-control",3,"keyup.enter"],["email",""],[1,"input-group","mb-4"],[1,"icon-lock"],["type","password","placeholder","M\u1eadt kh\u1ea9u","autocomplete","current-password","required","",1,"form-control",3,"keyup.enter"],["pass",""],["type","danger",4,"ngIf"],[1,"text-center"],["type","button",1,"btn","btn-primary","px-4",3,"disabled","click"],["type","danger"]],template:function(e,t){1&e&&(n.Vb(0,"div",0),n.Vb(1,"main",1),n.Vb(2,"div",2),n.Vb(3,"div",3),n.Vb(4,"div",4),n.Vb(5,"div",5),n.Vb(6,"div",6),n.Vb(7,"form"),n.Vb(8,"h1"),n.Fc(9,"\u0110\u0103ng nh\u1eadp"),n.Ub(),n.Vb(10,"p",7),n.Fc(11,"\u0110\u0103ng nh\u1eadp v\xe0o t\xe0i kho\u1ea3n"),n.Ub(),n.Vb(12,"div",8),n.Vb(13,"div",9),n.Vb(14,"span",10),n.Qb(15,"i",11),n.Ub(),n.Ub(),n.Vb(16,"input",12,13),n.cc("keyup.enter",function(){return t.login()}),n.Ub(),n.Ub(),n.Vb(18,"div",14),n.Vb(19,"div",9),n.Vb(20,"span",10),n.Qb(21,"i",15),n.Ub(),n.Ub(),n.Vb(22,"input",16,17),n.cc("keyup.enter",function(){return t.login()}),n.Ub(),n.Ub(),n.Dc(24,B,2,1,"alert",18),n.Vb(25,"div",19),n.Vb(26,"button",20),n.cc("click",function(){return t.login()}),n.Fc(27," \u0110\u0103ng nh\u1eadp "),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub(),n.Ub()),2&e&&(n.Db(24),n.lc("ngIf",void 0!==t.error),n.Db(2),n.lc("disabled",t.isLoading))},directives:[a.k,j.a],styles:["#box[_ngcontent-%COMP%]{width:400px}"]}),e})(),data:{title:"\u0110\u0103ng nh\u1eadp"},canActivate:[S]},{path:"",component:k,data:{title:"Home"},children:[{path:"",loadChildren:()=>Promise.all([i.e(1),i.e(11)]).then(i.bind(null,"6dU7")).then(e=>e.DashboardModule),canActivate:[U]},{path:"posts",loadChildren:()=>Promise.all([i.e(2),i.e(3),i.e(1),i.e(10)]).then(i.bind(null,"jBxN")).then(e=>e.PostsModule),canActivate:[U]},{path:"",loadChildren:()=>Promise.all([i.e(2),i.e(3),i.e(1),i.e(9)]).then(i.bind(null,"HsMK")).then(e=>e.NewpostModule),canActivate:[U]},{path:"",loadChildren:()=>Promise.all([i.e(2),i.e(12)]).then(i.bind(null,"WVqY")).then(e=>e.SecretModule),canActivate:[U]}]},{path:"**",component:A}];let E=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.Nb({type:e}),e.\u0275inj=n.Mb({imports:[[d.g.forRoot(P,{relativeLinkResolution:"legacy"})],d.g]}),e})();var V=i("2ZVE"),L=i("d2mR"),F=i("jmUF"),$=i("LC/r");const M={apiKey:"AIzaSyAz8_QhCv-LASvrswRsD-8kkjJyA3rCglA",authDomain:"prod-fanzone-admin.firebaseapp.com",projectId:"prod-fanzone-admin",storageBucket:"prod-fanzone-admin.appspot.com",messagingSenderId:"863658771489",appId:"1:863658771489:web:f0b0c8fbeb1a3d41324f60",measurementId:"G-J2ZJ71H83D"};var D=i("kLt5"),R=i("9ko8"),T=i("IheW"),x=i("qPgb"),z=i("JmXk"),J=i("Z93F"),N=i("KM76");let Z=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.Nb({type:e,bootstrap:[l]}),e.\u0275inj=n.Mb({providers:[{provide:a.h,useClass:a.p},c.c,b.a,D.a,R.a,N.a,x.a,z.a,J.a,r.c],imports:[[T.b,r.a,s.b,E,v.a.forRoot(),v.b,v.d,v.g,o.b,g.c.forRoot(),V.a.forRoot(),c.a,c.b.forRoot(),L.a,F.a.initializeApp(M),O.b,$.b,j.b.forRoot()]]}),e})();Object(n.U)(),r.d().bootstrapModule(Z,{useJit:!0,preserveWhitespaces:!0}).catch(e=>console.log(e))},zn8P:function(e,t){function i(e){return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}i.keys=function(){return[]},i.resolve=i,e.exports=i,i.id="zn8P"}},[[0,0,8]]]);